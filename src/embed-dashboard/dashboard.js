(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(8167)}])},8167:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return u},initDashboard:function(){return f}});var n=a(5893),i=a(7294),t=a(9008),r=a.n(t),c=a(42),l=a.n(c),d=e=>{let{title:s,metrics:a,type:i}=e,t=a.pageviews>0?(a.errors/a.pageviews*100).toFixed(1):"0.0",r="".concat(l().card," ").concat("canary"===i?l().canary:l().stable);return(0,n.jsxs)("div",{className:r,children:[(0,n.jsx)("h4",{className:l().title,children:s}),(0,n.jsxs)("ul",{className:l().list,children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:l().label,children:"Pageviews:"})," ",a.pageviews]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:l().label,children:"Clicks:"})," ",a.clicks]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:l().label,children:"Errors:"})," ",a.errors]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:l().label,children:"Error Rate:"})," ",t,"%"]})]})]})},o=a(4909),_=a.n(o),h=e=>{let{version:s,percentage:a}=e;return(0,n.jsxs)("div",{className:_().versionInfo,children:[(0,n.jsxs)("div",{className:_().assignmentInfo,children:[(0,n.jsx)("h3",{className:_().title,children:"Your Version"}),(0,n.jsx)("div",{className:_().version,children:(0,n.jsx)("div",{className:"".concat(_().tag," ").concat("canary"===s?_().canary:_().stable),children:s})})]}),(0,n.jsxs)("div",{className:_().distribution,children:[(0,n.jsx)("h3",{className:_().title,children:"Canary Distribution"}),(0,n.jsxs)("div",{className:_().percentageBar,children:[(0,n.jsx)("div",{className:_().canaryPercentage,style:{width:"".concat(a,"%")}}),(0,n.jsx)("span",{className:_().stablePercentage,style:{width:"".concat(100-a,"%")}})]}),(0,n.jsxs)("div",{className:_().labels,children:[(0,n.jsxs)("span",{children:["Canary: ",a,"%"]}),(0,n.jsxs)("span",{children:["Stable: ",100-a,"%"]})]})]})]})},v=a(3466),m=a.n(v),x=e=>{let{events:s}=e;return s&&0!==s.length?(0,n.jsxs)("div",{className:m().eventsContainer,children:[(0,n.jsx)("h3",{children:"Recent Events"}),(0,n.jsx)("ul",{className:m().eventsList,children:s.map((e,s)=>(0,n.jsxs)("li",{className:m().eventItem,children:[(0,n.jsx)("div",{className:m().eventType,children:e.type}),(0,n.jsx)("div",{className:m().eventTime,children:new Date(e.timestamp).toLocaleTimeString()})]},s))})]}):(0,n.jsxs)("div",{className:m().empty,children:[(0,n.jsx)("h3",{children:"Recent Events"}),(0,n.jsx)("p",{children:"No events recorded yet."})]})},j=a(660),b=a.n(j),p=e=>{let{data:s}=e;return s?(0,n.jsxs)("div",{className:b().dashboard,children:[(0,n.jsx)("h2",{className:b().title,children:"Canary Deployment Dashboard"}),(0,n.jsxs)("div",{className:b().grid,children:[(0,n.jsx)("div",{className:b().section,children:(0,n.jsx)(h,{version:s.assignment.version,percentage:s.config.initialCanaryPercentage})}),(0,n.jsxs)("div",{className:b().section,children:[(0,n.jsx)("h3",{children:"Metrics Comparison"}),(0,n.jsxs)("div",{className:b().metricsGrid,children:[(0,n.jsx)(d,{title:"Stable Version",metrics:s.metrics.stable,type:"stable"}),(0,n.jsx)(d,{title:"Canary Version",metrics:s.metrics.canary,type:"canary"})]})]}),(0,n.jsx)("div",{className:b().section,children:(0,n.jsx)(x,{events:s.metrics.events.slice(0,5)})})]})]}):(0,n.jsx)("div",{className:b().loading,children:"Loading canary data..."})};function u(){let[e,s]=(0,i.useState)(null);return(0,i.useEffect)(()=>{window.dashboardData?s(window.dashboardData):window.canary&&s({metrics:window.canary._metrics||{stable:{pageviews:0,errors:0,clicks:0},canary:{pageviews:0,errors:0,clicks:0},events:[]},assignment:window.canary._assignment||{version:"stable",timestamp:new Date().toISOString()},config:window.canary._config||{initialCanaryPercentage:5}}),window.__NEXT_DASHBOARD_UPDATE__=e=>{s(e)},window.addEventListener("dashboard-data-updated",()=>{window.dashboardData&&s(window.dashboardData)})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r(),{children:(0,n.jsx)("title",{children:"Canary Dashboard"})}),(0,n.jsx)(p,{data:e})]})}function f(e){{window.dashboardData=e;let s=new CustomEvent("dashboard-data-updated");window.dispatchEvent(s)}}},660:function(e){e.exports={dashboard:"Dashboard_dashboard__FnfVe",title:"Dashboard_title__UZeKr",grid:"Dashboard_grid__OoIFh",section:"Dashboard_section__6mn3y",metricsGrid:"Dashboard_metricsGrid__i0BxR",loading:"Dashboard_loading__RRlcS"}},3466:function(e){e.exports={eventsContainer:"EventsList_eventsContainer__F_D2J",eventsList:"EventsList_eventsList__8HWLo",eventItem:"EventsList_eventItem__QVOa1",eventType:"EventsList_eventType__24JCD",eventTime:"EventsList_eventTime__2zAvi",empty:"EventsList_empty__spL87"}},42:function(e){e.exports={card:"MetricsCard_card__vm_V4",stable:"MetricsCard_stable__JZdAI",canary:"MetricsCard_canary__XRk5M",title:"MetricsCard_title__bKslz",list:"MetricsCard_list__vtaKw",label:"MetricsCard_label__D_jWc"}},4909:function(e){e.exports={versionInfo:"VersionInfo_versionInfo__3S_vS",title:"VersionInfo_title__5FIZs",assignmentInfo:"VersionInfo_assignmentInfo__kvslh",version:"VersionInfo_version__acfZe",tag:"VersionInfo_tag__XsoGz",stable:"VersionInfo_stable__8KJWW",canary:"VersionInfo_canary__Yinax",distribution:"VersionInfo_distribution__4L_Y9",percentageBar:"VersionInfo_percentageBar___yuXV",canaryPercentage:"VersionInfo_canaryPercentage__AZN_r",stablePercentage:"VersionInfo_stablePercentage__pr_d9",labels:"VersionInfo_labels__ZEWoB"}},9008:function(e,s,a){e.exports=a(3867)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);
;(function(){
  // Create global initialization function to be called from bridge
  window.__NEXT_DASHBOARD_INIT__ = function(dashboardData) {
    // This assumes the Next.js app exports a default function 
    // that can be called with the canary data
    if (typeof self.__NEXT_LOADED_PAGES__[0][0].__N_SSG === "object") {
      // Initialize with canary data
      const appModule = self.__NEXT_LOADED_PAGES__[0][1];
      if (typeof appModule.initDashboard === 'function') {
        appModule.initDashboard(dashboardData);
      }
    }
    // Force hydration
    if (window.__NEXT_HYDRATE) {
      window.__NEXT_HYDRATE();
    }
  };

  // Create update function
  window.__NEXT_DASHBOARD_UPDATE__ = function(dashboardData) {
    // Dispatch custom event with updated data
    window.dashboardData = dashboardData;
    window.dispatchEvent(new CustomEvent('dashboard-data-updated'));
  };
})();